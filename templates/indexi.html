<!-- indexi.html -->


<!DOCTYPE html>
<html>
        <head>
                <title>Glorbenian Bank</title>
                <meta charset="UTF-8">
                <link rel="stylesheet" type="text/css" href="../static/style/style.css">
                <link rel="icon" type="image/png" href="../static/assets/gnbfav.png">

                <script>
                    const token = {{signature|tojson}};
                </script>
                <script src="../static/javascript_snippets_uwu/diggy.js"></script>
                <script src="../static/javascript_snippets_uwu/GNB.js"></script>
                <script src="../static/javascript_snippets_uwu/signature.js"></script>
                <script src="../static/javascript_snippets_uwu/form.js"></script>
        </head>
<style>
    .box {
        width:900px;
        left: calc(50% - 450px);
    }
        .bank-info {
            text-align: left;
            padding: 5px;
            font-size: 10px;
            color: var(--shade);
            border-radius: 15px;
            border: 2px solid var(--color2);
        }
    .silly-boy {
        width:400px;
        font-size:15px;
        font-family:Arial, Helvetica, sans-serif;
    }
    .silliest-billy {
        font-size:20px;
        font-family: "Comic Sans MS", "Comic Sans", cursive;
    }
    
    .mail {
        position: absolute;
        top: calc(20% - 70px);
        left: calc(50% + 625px);
        text-align:center;
        width: 300px;
        height: 600px;
        margin: 5px;
        background-color: var(--color3);
        box-shadow: 3px 3px var(--color2);
        border: 2px #000;
        border-radius: 15px;
    }

    .mail_box {
        width:235px;
        background-color: #fff;
        border: 2px solid #000;
        border-radius: 15px;
        padding:10px;
        margin:5px;
        padding-top:0px;
        text-align:left;
    }

</style>
<body onload="Adming()"><script src="../static/javascript_snippets_uwu/clock.js"></script>
    <h id="gooner2"></h>

    <!-- BUTTON CONTAINER -->
    <div id="button_container" style="position:relative; display:flex; top:calc(20% - 70px);left: calc(50% - 450px);width:fit-content;">
        <div class="homer">
            <form action="/login" method="POST">
                <input type="submit" value="Go to Login"/>
            </form>
        </div>
    </div>

    <!-- MAIL -->
    <div class="mail">
        <h1 style="font-size:20px;border:3px solid var(--color2);margin:10px;border-radius:5px;">Youwr mail, my pwince...&#129402</h1>
        <div class="mail" id="mail_list" style="background-color:var(--color2);top:calc(20% - 20px);left:5px;width:280px;height:485px;overflow-x:hidden;overflow-y:scroll;">

        </div>
    </div>


    <!-- MAIN BOX -->
    <div class="box" id="box">
    <h1>GLORBENIAN NATIONAL BANK</h1>
    <p id="welcome">Welcome, </p>
    <p>I love you Diggy</p>
    
    <div class="bank-info">
        <label for="balance_box" style="font-size:30px;font-family:Arial, Helvetica, sans-serif;text-decoration: underline;">Balance</label><br>
        <div class="bank-info"id="balance_box" style="display:inline-block;">
            <div style="display:flex;justify-content: center;align-items:center;">
                <label for="bank_balance_woolong" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;">Woolong:</label>
                <div id="bank_balance_woolong" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;margin:5px;"></div>
            </div>
            <br>
            <div style="display:flex;align-items:center;">
                <label for="bank_balance_parts" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;">Parts:</label>
                <div id="bank_balance_parts" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;margin:5px;"></div>
            </div>
            <br>
            <div style="display:flex;align-items:center;">
                <label for="bank_balance_credit" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;">Credit:</label>
                <div id="bank_balance_credit" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;margin:5px;"></div>
            </div>
        </div>
    </div>
    <br>

    <!-- Employer box -->
    <div id="employer_container" class="bank-info" style="display:inline-block;">
        <label for="employer" style="font-size:30px;font-family:Arial, Helvetica, sans-serif;text-decoration: underline;">Employer Info</label><br>
        <div class="bank-info" id="employer" style="display:inline-block;">
            <script>
                async function getOrganization(orgid) {
                    try {
                    const response = await fetch("/getorg", {
                        method: "POST",
                        headers: {"Content-Type": "application/json"},
                        body: JSON.stringify(orgid)
                    });
                    if (!response.ok) {
                        return response.status;
                    };
                    const data = await response.json();
                    return data.response;} catch (error) {
                        return error;
                    }
                };
                
            </script>
            <div style="display:flex;justify-content: center;align-items:center;">
                <label for="employer-name" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;">Company:</label>
                <div id="employer-name" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;margin:5px;"></div>
            </div>
            <script>
            </script>
            <div style="display:flex;justify-content: center;align-items:center">
                <label for="employer-contact" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;">Contact:</label>
                <div id="employer-contact" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;margin:5px;"></div>
            </div>
        </div>
    </div>
    <br><br>
    <!-- somethin else -->
    <div class="bank-info">
        <label for="gay" style="font-size:30px;font-family:Arial, Helvetica, sans-serif;text-decoration: underline;">Send Woolong to Another Account!</label>
        <div id="gay" class="bank-info">
            <script>
                    let total_money;
                    let user0;
                    let user7;
                    function validateTransaction(total_money) {


                        Signature(token, "Bank").then(result => {
                        total_money = result[1];
                        console.log(total_money);});


                        Signature(token, "User").then(result => {
                        user0 = result[0];
                        user7 = result[7];
                        console.log(user0, user7);});

                        let value = byId("num_woolong").value
                        let acc_to = byId("guhhhh").value;
                        byId("uhohhh").innerText = "";
                        byId("guh").disabled = true;
                        if (!isNumeric(value)) {
                            byId("guh").disabled = true;
                            byId("uhohhh").innerText = "Please enter a numeric number of Woolong.";
                        }
                        else if (!isNumeric(acc_to)) {
                            byId("guh").disabled = true; 
                            byId("uhohhh").innerText = "Please enter a numeric account ID.";
                        }
                        else if (value>total_money||value<0) {
                            byId("guh").disabled = true; 
                            byId("uhohhh").innerText = "Please enter a valid number of Woolong.";
                        }
                        else if (acc_to==user0) {
                            byId("guh").disabled = true; 
                            byId("uhohhh").innerText = "This is your account ID. You cannot send money to yourself!";
                        }
                        else if (value!=""&&acc_to!=""&&byId("nationalid").value==user7) {
                            if (value >= STL) {
                                byId("uhohhh").innerText = "You are transfering a large amount of Woolong. Due to this, a banker will have to manually confirm the transaction.";
                            } else {
                                byId("uhohhh").innerText = "Good job UwU Nya~! Have fun transfering thos woolong :3";
                            };
                            byId("guh").disabled = false;}

                    };
                    function subtractMoney(total_money) {
                        total_money -= parseInt(byId("num_woolong").value);
                    };
                </script>
            <form id="hehehe" action="/accountpage/sendmoney" method="POST">
                
                <h id="uhohhh" class="silliest-billy"></h><br><br><br>
                <input type="text" class="silly-boy" id="num_woolong" name="num_woolong" onkeyup="validateTransaction(total_money)" placeholder="Enter the number of woolong you would like to transfer"/>
                <br><br><input type="text" class="silly-boy" id="guhhhh" name="account_to_transfer" onkeyup="validateTransaction(total_money)" placeholder="Enter the account ID you would likee to transfer to"/>
                <br><br><input type="text" class="silly-boy" id="nationalid" name="nationalid" onkeyup="validateTransaction(total_money)" placeholder="Enter your national id"/>
                <br><br><input type="hidden" id="user" name="user"/>
                <br><br><button onclick="subtractMoney()" type="submit" style="font-size:20px;font-family:Arial, Helvetica, sans-serif;" id="guh" disabled>Send Woolong</button>
            </form>
        </div>
    </div>
    <br>


    <!-- depositing and withdrawing -->
    <div class="bank-info">
        <label for="depowithdr" style="font-size:30px;font-family:Arial, Helvetica, sans-serif;text-decoration: underline;">Deposit/Withdraw Woolong</label>
        <div id="depowithdr" class="bank-info" style="font-size:20px;">
            <!-- YAYAYA FIX PLS! -->
            <script>
                async function gumber() {
                    form("/CDOW", {
                        "select1":byId("select1").value,
                        "select2":byId("select2").value,
                        "select3":byId("select3").value,
                        "valuee":byId("valuee").value,
                        "natid":byId("nationalid_for_depo").value
                    })
                }
                let user7d;

                function validateNatId() {
                    g = byId("nationalid_for_depo").value;
                    Signature(token, "User").then(result => {
                    user7d = result[7];});

                    if ((g == user7d)&(byId("valuee").value>0)) {
                        byId("gumberbutton").disabled = false;
                    } else {
                        byId("gumberbutton").disabled = true;
                    }
                };
                    
            </script>
        
            <label for="select1">Deposit or withdraw?</label><br>
            <select name="select1" id="select1">
                <option value="deposit">Deposit</option>
                <option value="withdraw">Withdraw</option>
            </select>
            <br><br>
            <label for="select2">Where are you depositing from/withdrawing to?</label><br>
            <select name="select2" id="select2">
                <option value="uwg_discord_server">U.W.G. Discord Server - Discord Server</option>
                <option value="new_glorb_minecraft_server">New Glorb - Minecraft Server</option>
            </select>
            <br><br>
            <label for="select3">What currency?</label><br>
            <select name="select3" id="select3">
                <option value="woolong">Woolong</option>
                <option value="usd" disabled>USD</option>
            </select>
            <br><br>
            <input type="number" class="silly-boy" name="valuee" id="valuee" onkeyup="validateNatId()" placeholder="Enter the amount you would like to deposit/withdraw"/>
            <br><br>
            <h id="HELP"></h>
            <input type="number" class="silly-boy" id="nationalid_for_depo" name="nationalid_for_depo" onkeyup="validateNatId()" placeholder="Enter your national id"/>
            <br><br>
            <button id="gumberbutton" onclick="gumber()" disabled>Click :3</button>
        </div>
    </div>
    </div>
</body>
<!--
<script id="for mail :3">
    let ind = 0;
    function delMes(msgid) {
        byId(msgid).style.display = "none";
    }
    function add_mail_box(stufftitle, stuffinfo, stuffre) {
        // finish dis
        let mail_box = document.createElement("div");
        mail_box.className = "mail_box";
        mail_box.id = `MAILBOX${ind}`;
        
        let message_title = document.createElement("b");
        message_title.innerText = stufftitle;
        message_title.style = "font-size:20px;text-decoration:underline;"
        mail_box.appendChild(message_title);


        let message_info = document.createElement("p");
        message_info.innerText = stuffinfo;
        mail_box.appendChild(message_info);


        let message_contact = document.createElement("p");
        message_contact.style = "font-size:10px;text-align:right;"
        message_contact.innerText = stuffre;
        mail_box.appendChild(message_contact);
        
        /*
        byId("mail_list").appendChild(mail_box);

        let message_delete_botton = document.createElement("button");
        message_delete_button.textContent = "Delete";
        message_delete_button.onclick = `delMes(MAILBOX${ind})`;
        mail_box.appendChild(message_delete_button);
        
        fix this please
        */
        ind += 1;
    }
    let guh = 0;
    for (const stuff of mail_unread) {
        if (guh < 100) {
            add_mail_box(stuff[0], stuff[1], stuff[2]);
        }
    }
</script>
-->
<script>
    function Adming() {
        console.log(STL);
        setInterval(updateClock, 1000);
        Signature(token, "User")
        .then(result => {

            byId("welcome").textContent = `Welcome, ${result[1]} :3`;
            getOrganization(result[8]).then(res => {
                byId("employer-name").textContent = res[1];
                byId("employer-contact").textContent = res[2];})
            byId("user").value = result[7];
            if (result[4] > 1) {
                const Link = document.createElement("div");
                Link.className = "homer";
                const parentElement = byId("button_container");

                Link.className = "homer";
                Link.innerHTML = `<form action="/accountpage/datasheets" method="POST">
            <input type="hidden" name="datasheet" value="User"/>
            <input type="hidden" name="admin_user" value="${result}"/>
            <input type="submit" value="Datasheets"/>
            </form>`;
                parentElement.appendChild(Link);
            };
        });
        Signature(token, "Bank")
        .then(result => {
            byId("bank_balance_woolong").textContent = result[1];
            byId("bank_balance_parts").textContent = result[2];
            byId("bank_balance_credit").textContent = result[3];
        });

    };
</script>
